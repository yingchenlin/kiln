{
  "config": "configs/base.json",
  "groups": {
    "schemes": {
      "schemes": true,
      "layers": ["l2"]
    },
    "lin-apx": {
      "schemes": ["lin-apx"],
      "lin-apx": true
    },
    "cov": {
      "schemes": ["cov"],
      "cov-loss": ["mc"],
      "cov-biased": ["b1"],
      "cov-order": ["o2"],
      "cov-cross": ["c1"],
      "layers": ["l2"]
    },
    "lyr": {
      "schemes": ["mean"],
      "layers": true
    },
    "hpo": {
      "schemes": ["mean"],
      "std": ["s0.0"],
      "lr": true,
      "bs": true
    },
    "l2s": {
      "schemes": ["l2s"],
      "l2s": true
    },
    "l2w": {
      "schemes": ["l2w"],
      "l2w": true
    },
    "test": {
      "schemes": ["cov"]
    }
  },
  "factors": {
    "layers": {
      "l": {"model": {"dropout": {"layers": []}}},
      "l1": {"model": {"dropout": {"layers": [1]}}},
      "l2": {"model": {"dropout": {"layers": [2]}}},
      "l3": {"model": {"dropout": {"layers": [3]}}},
      "l123": {"model": {"dropout": {"layers": [1, 2, 3]}}}
    },
    "schemes": {
      "base": {},
      "none": {"model": {"dropout": {"std": 0}}},
      "mean": {"fit": {"num_samples": 16}},
      "weight": {"model": {"dropout": {"on": "weight", "layers": [0, 1, 2]}}},
      "normal": {"model": {"dropout": {"name": "normal"}}},
      "cov": {
        "model": {
          "name": "cov-mlp", 
          "activation": {
            "biased": true, 
            "order": 2, 
            "stop_grad": false
          },
          "dropout": {
            "dropout_cross": true,
            "state_stop_grad": false,
            "weight_stop_grad": false,
            "propagate_stop_grad": false
          }
        },
        "fit": {
          "loss_fn": {
            "name": "cov-mc-ce", 
            "num_samples": 1000, 
            "stop_grad": false
          }
        }
      },
      "lin-apx": {"model": {"dropout": {"name": "lin-apx"}}},
      "l2s": {"model": {"dropout": {"name": "l2", "on": "state", "std": 2e-5}}},
      "l2w": {"model": {"dropout": {"name": "l2", "on": "weight", "std": 1e-2}}}
    },
    "cov-loss": {
      "mc": {"fit": {"loss_fn": {"name": "cov-mc-ce", "num_samples": 1000}}},
      "quad": {"fit": {"loss_fn": {"name": "cov-quad-ce"}}}
    },
    "cov-order": {
      "o0": {"model": {"activation": {"order": 0}}},
      "o1": {"model": {"activation": {"order": 1}}},
      "o2": {"model": {"activation": {"order": 2}}}
    },
    "cov-biased": {
      "b0": {"model": {"activation": {"biased": false}}},
      "b1": {"model": {"activation": {"biased": true}}}
    },
    "cov-cross": {
      "c0": {"model": {"dropout": {"dropout_cross": false}}},
      "c1": {"model": {"dropout": {"dropout_cross": true}}}
    },
    "cov-stop-grad": {
      "gsg": {"model": {"activation": {"stop_grad": true}}},
      "xsg": {"model": {"dropout": {"state_stop_grad": true}}},
      "wsg": {"model": {"dropout": {"weight_stop_grad": true}}},
      "psg": {"model": {"dropout": {"propagate_stop_grad": true}}},
      "lsg": {"model": {"dropout": {"weight_stop_grad": true, "propagate_stop_grad": true}}},
      "hsg": {"fit": {"loss_fn": {"stop_grad": true}}}
    },
    "lr": {
      "l2e-3": {"fit": {"optimizer": {"learning_rate": 2e-3}}},
      "l5e-3": {"fit": {"optimizer": {"learning_rate": 5e-3}}},
      "l1e-2": {"fit": {"optimizer": {"learning_rate": 1e-2}}}
    },
    "bs": {
      "b50": {"dataset": {"train": {"batch_size": 50}}},
      "b100": {"dataset": {"train": {"batch_size": 100}}},
      "b200": {"dataset": {"train": {"batch_size": 200}}}
    },
    "std": {
      "s0.4": {"model": {"dropout": {"std": 0.4}}},
      "s0.5": {"model": {"dropout": {"std": 0.5}}},
      "s0.6": {"model": {"dropout": {"std": 0.6}}}
    },
    "l2s": {
      "0": {"model": {"dropout": {"std": 0}}},
      "1e-4": {"model": {"dropout": {"std": 1e-4}}},
      "5e-5": {"model": {"dropout": {"std": 5e-5}}},
      "2e-5": {"model": {"dropout": {"std": 2e-5}}},
      "1e-5": {"model": {"dropout": {"std": 1e-5}}},
      "5e-6": {"model": {"dropout": {"std": 5e-6}}}
    },
    "l2w": {
      "0": {"model": {"dropout": {"std": 0}}},
      "5e-2": {"model": {"dropout": {"std": 5e-2}}},
      "2e-2": {"model": {"dropout": {"std": 2e-2}}},
      "1e-2": {"model": {"dropout": {"std": 1e-2}}},
      "5e-3": {"model": {"dropout": {"std": 5e-3}}},
      "2e-3": {"model": {"dropout": {"std": 2e-3}}}
    }
  }
}
